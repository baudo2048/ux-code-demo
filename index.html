<html><head></head><body>
<script>
window.addEventListener('DOMContentLoaded', (event) => {
    document.head.appendChild(head());
    window.onload = () => {
        document.body.appendChild(body());
    }
});
</script>
<div id="ux-content-md" style="display:none">
<div id="ux-post-post"># Hello ux-md
Bla bla bla</div></div>
<script>function accordion() 
{
var root = document.createElement('div')
root.style.display='flex'
root.style.flexDirection='column'
var barProject_3 = barProject()
var searchComponent_4 = searchComponent()
searchComponent_4.style.margin='0'
searchComponent_4.style.padding='15px'
searchComponent_4.style.background='radial-gradient(circle, rgba(60,57,57,1) 0%, rgba(60,58,58,1) 100%, rgba(86,110,159,1) 100%)'
var div_8 = document.createElement('div')

root.appendChild(barProject_3)


root.appendChild(searchComponent_4)

div_8.style.display='flex'
div_8.style.flexDirection='column'
var a1 = document.createElement('div')
a1.style.color='white'
a1.style.fontWeight='bold'
a1.style.margin='0'
a1.style.padding='15px'
a1.style.border='3px solid black'
a1.style.background='rgb(60,57,57)'
a1.style.background='radial-gradient(circle, rgba(60,57,57,1) 0%, rgba(60,58,58,1) 100%, rgba(86,110,159,1) 100%)'
var textNode_19 = document.createTextNode('Project')
a1.append(textNode_19)
var div_20 = document.createElement('div')

div_8.appendChild(a1)

div_20.style.display='flex'
div_20.style.flexDirection='column'
div_20.style.alignContent='center'
var panelPrj = document.createElement('div')
panelPrj.style.display='block'
panelPrj.style.maxHeight='350px'
panelPrj.style.overflow='auto'
panelPrj.style.scrollbarColor='light'
panelPrj.style.padding='10px'
panelPrj.style.background='black'
panelPrj.style.color='white'

div_20.appendChild(panelPrj)


div_8.appendChild(div_20)


root.appendChild(div_8)

var acc = []

acc.push(a1)

for (var i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function() {
    /* Toggle between adding and removing the "active" class,
    to highlight the button that controls the panel */
    this.classList.toggle("active");

    /* Toggle between hiding and showing the active panel */
    var panel = this.nextElementSibling;
    if (panel.style.display === "block") {
      panel.style.display = "none";
    } else {
      panel.style.display = "block";
    }
  });
}

root.panelPrj = panelPrj

/* document.json('files', {folder: 'default'}).then(data=>{
    if(data.esito=='login'){
        import('./login.js').then(module=>{
            panelPrj.append(module.default())
        })
        return
    }

    data.forEach(v=>{
      var item = document.createElement('h5')
      item.innerHTML = v
      item.style.cursor = 'pointer'
      item.style.margin = '0'
      item.style.padding = '15px'
      item.onmouseover = ev => {item.style.background='radial-gradient(circle, rgba(60,57,57,1) 0%, rgba(60,58,58,1) 100%, rgba(86,110,159,1) 100%)'}
      item.onmouseleave = ev => {item.style.background='initial'}
      item.onclick = ev => {
        document.eventManager('showFile', {fileName: v, folder: 'default'})
      }
      panelPrj.append(item)
    })
}) */

/* fetch('/files', {
  method: 'POST',
  headers: {'Content-Type':'application/json'},
  body: JSON.stringify({folder: 'default'})
}).then(res=>{
  return res.json()
}).then(data => {
  data.forEach(v=>{
    var item = document.createElement('h5')
    item.innerHTML = v
    item.style.cursor = 'pointer'
    item.onclick = ev => {
      document.eventManager('showFile', {fileName: v, folder: 'default'})
    }
    panelPrj.append(item)
  })
}) */


document.register('accordion.filterFiles', ev => {
    var str = ev.detail
    Array.from(panelPrj.children).forEach(v => {
        if(!v.innerHTML.includes(str)){
            v.style.display = 'none'
        } else {
            v.style.display = 'flex'
        }
    })
    
})

document.register('accordion.showRegister', ev => {
    import('./register.js').then(module => {
        //panelCazzo!!!!! appartiene ad accortion?????
        panelPrj.innerHTML = ''
        panelPrj.append(module.default())
    })
})

document.register('accordion.showLogin', ev => {
    import('./login.js').then(module => {
        panelPrj.innerHTML = ''
        panelPrj.append(module.default())
    })  
})
root.setAttribute('ux-comp-name','accordion')
let style = document.createElement('style')
style.setAttribute('ux-comp-name-css','accordion')
style.textContent = ``
root.appendChild(style)
return root
}
function barProject() 
{
var topBar = document.createElement('div')
topBar.style.display='flex'
topBar.style.justifyContent='space-between'
topBar.style.alignItems='center'
topBar.style.border='3px solid black'
topBar.style.background='rgb(60,57,57)'
topBar.style.background='radial-gradient(circle, rgba(60,57,57,1) 0%, rgba(60,58,58,1) 100%, rgba(86,110,159,1) 100%)'
var div_7 = document.createElement('div')
div_7.style.display='flex'
var ctaNewProject = document.createElement('span')
ctaNewProject.append(document.createTextNode( '+ Project'))
ctaNewProject.style.margin='5px 5px'
ctaNewProject.style.padding='10px'
ctaNewProject.style.fontFamily='"Open Sans", "Courier New"'
ctaNewProject.style.fontSize='12px'
ctaNewProject.style.color='white'
var ctaNewComponent = document.createElement('span')
ctaNewComponent.append(document.createTextNode( '+ Component'))

div_7.appendChild(ctaNewProject)

ctaNewComponent.style.margin='5px 5px'
ctaNewComponent.style.padding='10px'
ctaNewComponent.style.fontFamily='"Open Sans", "Courier New"'
ctaNewComponent.style.fontSize='12px'
ctaNewComponent.style.color='white'

div_7.appendChild(ctaNewComponent)


topBar.appendChild(div_7)

ctaNewProject .onclick = ev => {

}

ctaNewProject .onmouseover = ev => {
    ctaNewProject.style.background = 'rgb(35,38,39)'
    ctaNewProject.style.background = 'radial-gradient(circle, rgba(35,38,39,0.9982274159663865) 100%, rgba(235,235,235,1) 100%, rgba(86,110,159,1) 100%)'
}

ctaNewProject .onmouseleave = ev => {
    ctaNewProject.style.background = 'initial'

    //if(!isMouseOver) mnuFile.style.display = 'none'
}



ctaNewComponent.onclick = ev => {

}

ctaNewComponent.onmouseover = ev => {
    ctaNewComponent.style.background = 'rgb(35,38,39)'
    ctaNewComponent.style.background = 'radial-gradient(circle, rgba(35,38,39,0.9982274159663865) 100%, rgba(235,235,235,1) 100%, rgba(86,110,159,1) 100%)'
}

ctaNewComponent.onmouseleave = ev => {
    ctaNewComponent.style.background = 'initial'

    //if(!isMouseOver) mnuFile.style.display = 'none'
}
topBar.setAttribute('ux-comp-name','barProject')
let style = document.createElement('style')
style.setAttribute('ux-comp-name-css','barProject')
style.textContent = ``
topBar.appendChild(style)
return topBar
}
function body() 
{
var body = document.createElement('div')
var homeDesktop_1 = homeDesktop()

body.appendChild(homeDesktop_1)


body.setAttribute('ux-comp-name','body')
let style = document.createElement('style')
style.setAttribute('ux-comp-name-css','body')
style.textContent = ``
body.appendChild(style)
return body
}
function eventConf() 
{
var root = document.createElement('div')

    function dispatch (eventName, msg) {
        console.log('dispatch - ' + eventName);
        var detail = {detail: msg};
        document.dispatchEvent(new CustomEvent(eventName, detail));
    }
    
    // export function dispatch2 (eventName, msg, from, to)
    
    function register (eventName, callback){
        document.addEventListener(eventName, callback);
    }
    
    function unregister (eventName, callback){
        document.removeEventListener(eventName, callback);
    }
    
    function registerDefault (callback){
        document.addEventListener(callback.name, callback);
    }
    
    document.registerDefault = registerDefault
    document.em = dispatch
    document.register = register
    document.unregister = unregister


root.setAttribute('ux-comp-name','eventConf')
let style = document.createElement('style')
style.setAttribute('ux-comp-name-css','eventConf')
style.textContent = ``
root.appendChild(style)
return root
}
function head() 
{
var head = document.createElement('div')
var meta_1 = document.createElement('meta')
meta_1.setAttribute('charset', 'utf-8')
var meta_3 = document.createElement('meta')

head.appendChild(meta_1)

meta_3.setAttribute('name', 'viewport')
meta_3.setAttribute('content', 'width=device-width, initial-scale=1, shrink-to-fit=no')
var meta_6 = document.createElement('meta')

head.appendChild(meta_3)

meta_6.setAttribute('http-equiv', 'x-ua-compatible')
meta_6.setAttribute('content', 'ie=edge')
var link_9 = document.createElement('link')

head.appendChild(meta_6)

link_9.setAttribute('href', 'https://use.fontawesome.com/releases/v5.15.2/css/all.css')
link_9.setAttribute('rel', 'stylesheet')
var link_12 = document.createElement('link')

head.appendChild(link_9)

link_12.setAttribute('href', 'https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap')
link_12.setAttribute('rel', 'stylesheet')
var link_15 = document.createElement('link')

head.appendChild(link_12)

link_15.setAttribute('rel', 'stylesheet')
link_15.setAttribute('href', 'https://fonts.googleapis.com/icon?family=Material+Icons')
var link_18 = document.createElement('link')

head.appendChild(link_15)

link_18.setAttribute('rel', 'stylesheet')
link_18.setAttribute('href', 'https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css')
link_18.setAttribute('integrity', 'sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l')
link_18.setAttribute('crossOrigin', 'anonymous')
var link_23 = document.createElement('link')

head.appendChild(link_18)

link_23.setAttribute('href', '../assets/css/ux.css')
link_23.setAttribute('rel', 'stylesheet')
var link_26 = document.createElement('link')

head.appendChild(link_23)

link_26.setAttribute('href', '../assets/css/style.css')
link_26.setAttribute('rel', 'stylesheet')
var script_29 = document.createElement('script')

head.appendChild(link_26)

script_29.setAttribute('src', 'https://unpkg.com/@popperjs/core@2.4.0/dist/umd/popper.min.js')
var script_31 = document.createElement('script')

head.appendChild(script_29)

script_31.setAttribute('src', 'https://code.jquery.com/jquery-3.2.1.slim.min.js')
script_31.setAttribute('integrity', 'sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN')
script_31.setAttribute('crossOrigin', 'anonymous')
var script_35 = document.createElement('script')

head.appendChild(script_31)

script_35.setAttribute('src', 'https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js')
script_35.setAttribute('integrity', 'sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf')
script_35.setAttribute('crossOrigin', 'anonymous')
var script_39 = document.createElement('script')

head.appendChild(script_35)

script_39.setAttribute('src', 'https://unpkg.com/@reactivex/rxjs@6.0.0/dist/global/rxjs.umd.js')
var script_41 = document.createElement('script')

head.appendChild(script_39)

script_41.setAttribute('src', 'https://d3js.org/d3.v6.min.js')
var script_43 = document.createElement('script')

head.appendChild(script_41)

script_43.setAttribute('src', 'https://d3js.org/d3-dispatch.v2.min.js')
var script_45 = document.createElement('script')

head.appendChild(script_43)

script_45.setAttribute('src', 'https://d3js.org/d3-selection.v2.min.js')
var script_47 = document.createElement('script')

head.appendChild(script_45)

script_47.setAttribute('src', 'https://d3js.org/d3-drag.v2.min.js')
var script_49 = document.createElement('script')

head.appendChild(script_47)

script_49.setAttribute('src', 'https://cdnjs.cloudflare.com/ajax/libs/markdown-it/12.0.4/markdown-it.min.js')
script_49.setAttribute('integrity', 'sha512-0DkA2RqFvfXBVeti0R1l0E8oMkmY0X+bAA2i02Ld8xhpjpvqORUcE/UBe+0KOPzi5iNah0aBpW6uaNNrqCk73Q==')
script_49.setAttribute('crossOrigin', 'anonymous')
var script_53 = document.createElement('script')

head.appendChild(script_49)

script_53.setAttribute('src', '../assets/js/ux.js')
var title_55 = document.createElement('title')
title_55.append(document.createTextNode( 'UX Basic Bootstrap Template'))

head.appendChild(script_53)


head.appendChild(title_55)

eventConf()
restConf()
head.setAttribute('ux-comp-name','head')
let style = document.createElement('style')
style.setAttribute('ux-comp-name-css','head')
style.textContent = ``
head.appendChild(style)
return head
}
function help() 
{
var root = document.createElement('div')
//var w = windowDev.getCalculated width


root.setAttribute('ux-comp-name','help')
let style = document.createElement('style')
style.setAttribute('ux-comp-name-css','help')
style.textContent = ``
root.appendChild(style)
return root
}
function homeDesktop() 
{
var root = document.createElement('div')
root.style.display='flex'
root.style.flexDirection='column'
root.style.height='100%'
root.style.alignContent='center'
root.style.background='rgb(2,0,36)'
root.style.background='radial-gradient(circle, rgba(2,0,36,1) 0%, rgba(9,9,121,1) 35%, rgba(0,212,255,1) 100%)'
var header = document.createElement('div')
header.style.display='flex'
header.style.alignContent='center'
var btnHome = document.createElement('span')
btnHome.append(document.createTextNode( 'Kate Code'))
btnHome.style.display='flex'
btnHome.style.alignContent='center'
btnHome.style.fontFamily='Segoe UI'
btnHome.style.color='white'
btnHome.style.fontWeight='bold'
btnHome.style.fontSize='13px'
btnHome.style.margin='3px'
btnHome.style.maxHeight='30px'
btnHome.style.backgroundColor='transparent'
btnHome.style.padding='10px'
var btn1 = document.createElement('button')
btn1.append(document.createTextNode( '+ New Project'))

header.appendChild(btnHome)

btn1.style.fontSize='12px'
btn1.style.margin='3px'
btn1.style.maxHeight='30px'
btn1.style.backgroundColor='rgb(0, 0, 128)'
btn1.style.padding='10px'
btn1.setAttribute('className', 'bttn-pill bttn-md')
var ctaExplore = document.createElement('button')
ctaExplore.append(document.createTextNode( 'Explore'))

header.appendChild(btn1)

ctaExplore.style.fontSize='12px'
ctaExplore.style.margin='3px'
ctaExplore.style.maxHeight='30px'
ctaExplore.style.padding='10px'
ctaExplore.style.backgroundColor='#BDF6E2'
ctaExplore.style.fontWeight='bold'
ctaExplore.style.color='#1c1c1c'
ctaExplore.style.cursor='pointer'
var btn2 = document.createElement('button')
btn2.append(document.createTextNode( 'Editor'))

header.appendChild(ctaExplore)

btn2.style.fontSize='12px'
btn2.style.minWidth='60px'
btn2.style.maxHeight='30px'
btn2.style.margin='3px'
btn2.style.padding='10px'
btn2.style.backgroundColor='rgb(66, 184, 221)'
btn2.style.fontWeight='bold'
btn2.style.color='white'
btn2.style.cursor='pointer'
var btn3 = document.createElement('button')
btn3.append(document.createTextNode( 'Paletta'))

header.appendChild(btn2)

btn3.style.fontSize='12px'
btn3.style.minWidth='60px'
btn3.style.maxHeight='30px'
btn3.style.margin='3px'
btn3.style.backgroundColor='rgb(0, 255, 128)'
btn3.style.padding='10px'
btn3.setAttribute('className', 'bttn-pill bttn-md')
var btnHelp = document.createElement('button')
btnHelp.append(document.createTextNode( 'Getting started'))

header.appendChild(btn3)

btnHelp.style.minWidth='60px'
btnHelp.style.maxHeight='30px'
btnHelp.style.fontSize='12px'
btnHelp.style.margin='3px'
btnHelp.style.padding='10px'
btnHelp.style.backgroundColor='rgb(66, 184, 221)'
btnHelp.style.fontWeight='bold'
btnHelp.style.color='white'
btnHelp.style.cursor='pointer'
var div_65 = document.createElement('div')

header.appendChild(btnHelp)

div_65.style.flexGrow='1'
var user_67 = user()

header.appendChild(div_65)

var div_68 = document.createElement('div')

header.appendChild(user_67)

div_68.style.display='flex'
div_68.style.flexGrow='1'
var sidebar = document.createElement('div')
sidebar.style.display='flex'
sidebar.style.flexDirection='column'
sidebar.style.justifyContent='flex-start'
sidebar.style.alignContent='flex-start'
sidebar.style.width='250px'
sidebar.style.background='radial-gradient(circle, rgba(60,57,57,1) 0%, rgba(60,58,58,1) 100%, rgba(86,110,159,1) 100%)'
var acc1 = accordion()
var content = document.createElement('div')

sidebar.appendChild(acc1)

content.style.display='flex'
content.style.overflow='none'
content.style.flexGrow='1'
content.style.backgroundColor='#f3f3f3'
var loginPage = login()
var w2 = windowDev()

content.appendChild(loginPage)


content.appendChild(w2)


div_68.appendChild(sidebar)


div_68.appendChild(content)


root.appendChild(header)


root.appendChild(div_68)

loginPage.style.display = 'none'



//helpComp.style.display = 'none'




w2.style.display = 'flex'



 btn2.onclick = ev =>{
    //helpComp.style.display = 'none'
    w2.style.display = 'flex'
    loginPage.style.display = 'none'

    sidebar.style.display = 'flex'
}


btn1.onclick = ev => {
    var prjName = (prompt("Nome del progetto (no spazi, no caratteri speciali)")).trim()
    if(prjName=='' || prjName==null){
        return
    }

}

btn3.style.display = 'none'
btn3.onclick = ev => {
    wPaletta.style.display = 'flex'
}


// btnHelp.onclick = ev => {
//     w2.style.display = 'none'
//     helpComp.style.display ='flex'
//     loginPage.style.display = 'none'

//     sidebar.style.display = 'none'

//     helpComp.focus()
// }

document.register('homeDesktop.showLogin', ev => {
    loginPage.style.display = 'flex'
    w2.style.display = 'none'
    //helpComp.style.display = 'none'
}) 
root.setAttribute('ux-comp-name','homeDesktop')
let style = document.createElement('style')
style.setAttribute('ux-comp-name-css','homeDesktop')
style.textContent = ``
root.appendChild(style)
return root
}
function login() 
{
var root = document.createElement('div')
root.style.display='flex'
root.style.flexDirection='column'
var h3_3 = document.createElement('h3')
h3_3.append(document.createTextNode( 'Load your workspace'))
h3_3.style.textAlign='center'
var mail = document.createElement('input')
mail.append(document.createTextNode( 'mail'))

root.appendChild(h3_3)

mail.style.textAlign='center'
mail.setAttribute('type', 'text')
mail.setAttribute('placeholder', 'mail')
var pass = document.createElement('input')
pass.append(document.createTextNode( 'password'))

root.appendChild(mail)

pass.style.textAlign='center'
pass.setAttribute('type', 'password')
pass.setAttribute('placeholder', 'password')
var ctaLogin = document.createElement('button')
ctaLogin.append(document.createTextNode( 'Login'))

root.appendChild(pass)

var br_14 = document.createElement('br')
var p_15 = document.createElement('p')
var ctaRegister = document.createElement('a')
ctaRegister.append(document.createTextNode( 'Create an account'))
ctaRegister.style.cursor='pointer'
ctaRegister.style.fontSize='12px'
ctaRegister.style.color='blue'
ctaRegister.style.textDecoration='underline'

p_15.appendChild(ctaRegister)


root.appendChild(ctaLogin)


root.appendChild(br_14)


root.appendChild(p_15)

ctaLogin.onclick = ev => {
    document.cookie = 'user=' + mail.value
    document.cookie = 'pass=' + pass.value
}


ctaRegister.onclick = ev => {
    document.em('accordion.showRegister')
}
root.setAttribute('ux-comp-name','login')
let style = document.createElement('style')
style.setAttribute('ux-comp-name-css','login')
style.textContent = ``
root.appendChild(style)
return root
}
function menuFile() 
{
var root = document.createElement('div')
root.style.position='fixed'
root.style.border='1px solid white'
root.style.background='rgb(60,57,57)'
root.style.background='radial-gradient(circle, rgba(60,57,57,1) 0%, rgba(60,58,58,1) 100%, rgba(86,110,159,1) 100%)'
var ctaNew = document.createElement('div')
ctaNew.append(document.createTextNode( 'New'))
ctaNew.style.margin='5px 5px'
ctaNew.style.padding='10px'
ctaNew.style.fontFamily='"Open Sans", "Courier New"'
ctaNew.style.fontSize='12px'
ctaNew.style.color='white'
var ctaOpen = document.createElement('div')
ctaOpen.append(document.createTextNode( 'Open'))

root.appendChild(ctaNew)

ctaOpen.style.margin='5px 5px'
ctaOpen.style.padding='10px'
ctaOpen.style.fontFamily='"Open Sans", "Courier New"'
ctaOpen.style.fontSize='12px'
ctaOpen.style.color='white'
var ctaSave = document.createElement('div')
ctaSave.append(document.createTextNode( 'Save'))

root.appendChild(ctaOpen)

ctaSave.style.margin='5px 5px'
ctaSave.style.padding='10px'
ctaSave.style.fontFamily='"Open Sans", "Courier New"'
ctaSave.style.fontSize='12px'
ctaSave.style.color='white'
var ctaImport = document.createElement('div')
ctaImport.append(document.createTextNode( 'import'))

root.appendChild(ctaSave)

ctaImport.style.margin='5px 5px'
ctaImport.style.padding='10px'
ctaImport.style.fontFamily='"Open Sans", "Courier New"'
ctaImport.style.fontSize='12px'
ctaImport.style.color='white'

root.appendChild(ctaImport)

ctaNew.onmouseover = ev => {
    ctaNew.style.background = 'rgb(35,38,39)'
    ctaNew.style.background = 'radial-gradient(circle, rgba(35,38,39,0.9982274159663865) 100%, rgba(235,235,235,1) 100%, rgba(86,110,159,1) 100%)'
}

ctaNew.onmouseleave = ev => {
    ctaNew.style.background = 'initial'
}

ctaOpen.onmouseover = ev => {
    ctaOpen.style.background = 'rgb(35,38,39)'
    ctaOpen.style.background = 'radial-gradient(circle, rgba(35,38,39,0.9982274159663865) 100%, rgba(235,235,235,1) 100%, rgba(86,110,159,1) 100%)'
}

ctaOpen.onmouseleave = ev => {
    ctaOpen.style.background = 'initial'
}

ctaSave.onmouseover = ev => {
    ctaSave.style.background = 'rgb(35,38,39)'
    ctaSave.style.background = 'radial-gradient(circle, rgba(35,38,39,0.9982274159663865) 100%, rgba(235,235,235,1) 100%, rgba(86,110,159,1) 100%)'
}

ctaSave.onmouseleave = ev => {
    ctaSave.style.background = 'initial'
}

ctaImport.onmouseover = ev => {
    ctaImport.style.background = 'rgb(35,38,39)'
    ctaImport.style.background = 'radial-gradient(circle, rgba(35,38,39,0.9982274159663865) 100%, rgba(235,235,235,1) 100%, rgba(86,110,159,1) 100%)'
}

ctaImport.onmouseleave = ev => {
    ctaImport.style.background = 'initial'
}
root.setAttribute('ux-comp-name','menuFile')
let style = document.createElement('style')
style.setAttribute('ux-comp-name-css','menuFile')
style.textContent = ``
root.appendChild(style)
return root
}
function menuTools() 
{
var root = document.createElement('div')
root.style.position='fixed'
root.style.border='1px solid white'
root.style.background='rgb(60,57,57)'
root.style.background='radial-gradient(circle, rgba(60,57,57,1) 0%, rgba(60,58,58,1) 100%, rgba(86,110,159,1) 100%)'
var ctaToolbox = document.createElement('div')
ctaToolbox.append(document.createTextNode( 'CSS toolbox'))
ctaToolbox.style.margin='5px 5px'
ctaToolbox.style.padding='10px'
ctaToolbox.style.fontFamily='"Open Sans", "Courier New"'
ctaToolbox.style.fontSize='12px'
ctaToolbox.style.color='white'
var ctaDomselector = document.createElement('div')
ctaDomselector.append(document.createTextNode( 'Dom Selector'))

root.appendChild(ctaToolbox)

ctaDomselector.style.margin='5px 5px'
ctaDomselector.style.padding='10px'
ctaDomselector.style.fontFamily='"Open Sans", "Courier New"'
ctaDomselector.style.fontSize='12px'
ctaDomselector.style.color='white'
var div_17 = document.createElement('div')
div_17.append(document.createTextNode( 'Show/Hide -css properties'))

root.appendChild(ctaDomselector)

div_17.style.margin='5px 5px'
div_17.style.padding='10px'
div_17.style.fontFamily='"Open Sans", "Courier New"'
div_17.style.fontSize='12px'
div_17.style.color='white'

root.appendChild(div_17)

ctaToolbox.onmouseover = ev => {
    ctaToolbox.style.background = 'rgb(35,38,39)'
    ctaToolbox.style.background = 'radial-gradient(circle, rgba(35,38,39,0.9982274159663865) 100%, rgba(235,235,235,1) 100%, rgba(86,110,159,1) 100%)'
}

ctaToolbox.onmouseleave = ev => {
    ctaToolbox.style.background = 'initial'
}

ctaDomselector.onmouseover = ev => {
    ctaDomselector.style.background = 'rgb(35,38,39)'
    ctaDomselector.style.background = 'radial-gradient(circle, rgba(35,38,39,0.9982274159663865) 100%, rgba(235,235,235,1) 100%, rgba(86,110,159,1) 100%)'
}

ctaDomselector.onmouseleave = ev => {
    ctaDomselector.style.background = 'initial'
}

root.setAttribute('ux-comp-name','menuTools')
let style = document.createElement('style')
style.setAttribute('ux-comp-name-css','menuTools')
style.textContent = ``
root.appendChild(style)
return root
}
function restConf() 
{
var root = document.createElement('div')
function json(serviceName, msg={}, mode='cors'){
    const host = 'http://localhost:3000/';

    return new Promise( (resolve, reject) => {
        // prendo i cookie
        // document.cookie = "user=admin@katecode.com;pass=admin"
        
        //document.cookie = "user=admin@katecode.com;pass=admin"
        //document.cookie = "pass=admi"
        
        // *************** Vanilla cookie
        var props = document.cookie.split(';')

        var user = ''
        var pass = ''

        props.forEach(v => {
          var tokens = v.split('=')
          if(tokens[0]=='user'){
            user = tokens[1]
          }
          if(tokens[0].trim()=='pass'){
            pass = tokens[1]
          }
        })
        //********************************
        
        // npm js-cookie
        //Cookies.set('user','root')
        //Cookies.set('pass','root')
        
      

        fetch(host+serviceName, {
            mode: mode, //same-origin
            method: 'POST', 
            headers: {
                "Content-type": "application/json; charset=UTF-8"
            },
            body: JSON.stringify(msg) // body data type must match "Content-Type" header
        }).then( response => {
            return response.json()
        }).then(data => {
            console.log('fetching response ... data is + ' + JSON.stringify(data))
            //document.eventManager(`${serviceName}.response`, data)
            resolve(data)
        }).catch(error => {
            reject(error)
        });
    })

}

document.json = json;
root.setAttribute('ux-comp-name','restConf')
let style = document.createElement('style')
style.setAttribute('ux-comp-name-css','restConf')
style.textContent = ``
root.appendChild(style)
return root
}
function searchComponent() 
{
var root = document.createElement('div')
root.style.border='3px solid black'
var form_2 = document.createElement('form')
form_2.setAttribute('className', 'pure-form')
var strSearch = document.createElement('input')
strSearch.setAttribute('className', 'pure-input-rounded')
strSearch.setAttribute('type', 'text')

form_2.appendChild(strSearch)


root.appendChild(form_2)

strSearch.onkeyup = ev => {
    //Dall'accordion remove what doesn't match

    document.em('accordion.filterFiles', strSearch.value)
}
root.setAttribute('ux-comp-name','searchComponent')
let style = document.createElement('style')
style.setAttribute('ux-comp-name-css','searchComponent')
style.textContent = ``
root.appendChild(style)
return root
}
function snippets() 
{
var div_0 = document.createElement('div')
var link_1 = document.createElement('link')
link_1.setAttribute('rel', 'stylesheet')
link_1.setAttribute('href', 'https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css')
link_1.setAttribute('integrity', 'sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l')
link_1.setAttribute('crossOrigin', 'anonymous')

div_0.appendChild(link_1)


div_0.setAttribute('ux-comp-name','snippets')
let style = document.createElement('style')
style.setAttribute('ux-comp-name-css','snippets')
style.textContent = ``
div_0.appendChild(style)
return div_0
}
function user() 
{
var root = document.createElement('div')
var ctaUser = document.createElement('img')
ctaUser.style.marginRight='20px'
ctaUser.style.cursor='pointer'
ctaUser.setAttribute('src', './img/baseline_person_outline_white_18dp.png')
var mnuUser = document.createElement('div')

root.appendChild(ctaUser)

mnuUser.style.display='none'
mnuUser.style.position='fixed'
mnuUser.style.border='1px solid black'
mnuUser.style.backgroundColor='white'
mnuUser.style.zIndex='101'
var user = document.createElement('h3')
user.append(document.createTextNode( 'Username'))
var mail = document.createElement('p')
mail.append(document.createTextNode( 'user@mail.com'))
var ctaSignout = document.createElement('button')
ctaSignout.append(document.createTextNode( 'Sign out'))
var mnuGuest = document.createElement('div')

mnuUser.appendChild(user)


mnuUser.appendChild(mail)


mnuUser.appendChild(ctaSignout)

mnuGuest.style.display='none'
mnuGuest.style.position='fixed'
mnuGuest.style.border='1px solid black'
mnuGuest.style.backgroundColor='white'
mnuGuest.style.zIndex='101'
var login_20 = login()

mnuGuest.appendChild(login_20)


root.appendChild(mnuUser)


root.appendChild(mnuGuest)

// **************** MENU USER
var isMouseOver = false
mnuUser.style.display = 'none'
ctaUser.onclick = ev => {

    // Prendo il cookie
    // Se funzia visualizzo logout altrimenti login mnuGuest
    if(mnuUser.style.display=='none'){

        var rect = ctaUser.getBoundingClientRect()
    
        mnuUser.style.top = rect.bottom +'px'
        mnuUser.style.left = '0px'

        mnuUser.style.padding = '10px'
        mnuUser.style.position = 'fixed'
        mnuUser.style.display = 'initial'

        var rectMnu = mnuUser.getBoundingClientRect()
        mnuUser.style.left= rect.right - rectMnu.right + rectMnu.left + 'px'
    } else {
        mnuUser.style.display = 'none'
    }
}



// **********************************************

ctaSignout.onclick = ev => {
    document.cookie = 'user=foo'
    document.cookie = 'pass=foo'
    mnuUser.style.display = 'none'
}
root.setAttribute('ux-comp-name','user')
let style = document.createElement('style')
style.setAttribute('ux-comp-name-css','user')
style.textContent = ``
root.appendChild(style)
return root
}
function windowDev() 
{
var root = document.createElement('div')
root.style.display='flex'
root.style.flexBasis='100%'
root.style.width='660px'
root.style.height='580px'
root.style.flexDirection='column'
root.style.border='3px solid black'
root.style.overflow='none'
root.style.zIndex='100'
root.style.boxSizing='border-box'
var topBar = document.createElement('div')
topBar.style.display='flex'
topBar.style.justifyContent='space-between'
topBar.style.alignItems='center'
topBar.style.background='rgb(60,57,57)'
topBar.style.background='radial-gradient(circle, rgba(60,57,57,1) 0%, rgba(60,58,58,1) 100%, rgba(86,110,159,1) 100%)'
var div_16 = document.createElement('div')
div_16.style.display='flex'
var windowImgMove = document.createElement('span')
windowImgMove.append(document.createTextNode( '*'))
windowImgMove.style.margin='5px 5px'
windowImgMove.style.padding='10px'
windowImgMove.style.fontFamily='"Open Sans", "Courier New"'
windowImgMove.style.fontSize='12px'
windowImgMove.style.color='white'
windowImgMove.setAttribute('move', 'window')
var ctaFile = document.createElement('span')
ctaFile.append(document.createTextNode( 'File'))

div_16.appendChild(windowImgMove)

ctaFile.style.margin='5px 5px'
ctaFile.style.padding='10px'
ctaFile.style.fontFamily='"Open Sans", "Courier New"'
ctaFile.style.fontSize='12px'
ctaFile.style.color='white'
var mnuFile = menuFile()
var ctaTools = document.createElement('span')
ctaTools.append(document.createTextNode( 'Tools'))

ctaFile.appendChild(mnuFile)

ctaTools.style.margin='5px 5px'
ctaTools.style.padding='10px'
ctaTools.style.fontFamily='"Open Sans", "Courier New"'
ctaTools.style.fontSize='12px'
ctaTools.style.color='white'
var mnuTools = menuTools()
var imgCode = document.createElement('span')
imgCode.append(document.createTextNode( '{html}'))

ctaTools.appendChild(mnuTools)

imgCode.style.margin='5px 5px'
imgCode.style.padding='10px'
imgCode.style.fontFamily='"Open Sans", "Courier New"'
imgCode.style.fontSize='12px'
imgCode.style.color='white'
imgCode.style.background='green'
var imgScript = document.createElement('span')
imgScript.append(document.createTextNode( '{js}'))

div_16.appendChild(ctaFile)


div_16.appendChild(ctaTools)


div_16.appendChild(imgCode)

imgScript.style.margin='5px 5px'
imgScript.style.padding='10px'
imgScript.style.fontFamily='"Open Sans", "Courier New"'
imgScript.style.fontSize='12px'
imgScript.style.color='white'
var imgCss = document.createElement('span')
imgCss.append(document.createTextNode( '{css}'))

div_16.appendChild(imgScript)

imgCss.style.margin='5px 5px'
imgCss.style.padding='10px'
imgCss.style.fontFamily='"Open Sans", "Courier New"'
imgCss.style.fontSize='12px'
imgCss.style.color='white'
var imgSaveAlt = document.createElement('span')
imgSaveAlt.append(document.createTextNode( 'Save'))

div_16.appendChild(imgCss)

imgSaveAlt.style.margin='5px 5px'
imgSaveAlt.style.padding='10px'
imgSaveAlt.style.fontFamily='"Open Sans", "Courier New"'
imgSaveAlt.style.fontSize='12px'
imgSaveAlt.style.color='white'
imgSaveAlt.style.background='orange'
imgSaveAlt.style.cursor='pointer'
var imgDesign = document.createElement('span')
imgDesign.append(document.createTextNode( 'Design'))

div_16.appendChild(imgSaveAlt)

imgDesign.style.margin='5px 5px'
imgDesign.style.padding='10px'
imgDesign.style.fontFamily='"Open Sans", "Courier New"'
imgDesign.style.fontSize='12px'
imgDesign.style.color='white'
imgDesign.style.background='orange'
imgDesign.style.cursor='pointer'
var imgPreview = document.createElement('span')
imgPreview.append(document.createTextNode( 'Preview'))

div_16.appendChild(imgDesign)

imgPreview.style.margin='5px 5px'
imgPreview.style.padding='10px'
imgPreview.style.fontFamily='"Open Sans", "Courier New"'
imgPreview.style.fontSize='12px'
imgPreview.style.color='white'
imgPreview.style.background='orange'
imgPreview.style.cursor='pointer'
var div_82 = document.createElement('div')

div_16.appendChild(imgPreview)


topBar.appendChild(div_16)

div_82.style.display='flex'
div_82.style.flexGrow='1'
var fileName = document.createElement('input')
fileName.style.width='100%'
fileName.style.height='30px'
fileName.style.marginLeft='10px'
fileName.style.marginRight='10px'
fileName.style.fontSize='large'
fileName.setAttribute('type', 'text')
fileName.setAttribute('value', 'componentName.ux')
var div_93 = document.createElement('div')

div_82.appendChild(fileName)


topBar.appendChild(div_82)

div_93.style.display='flex'
var imgDownload = document.createElement('span')
imgDownload.append(document.createTextNode( 'Download'))
imgDownload.style.margin='5px 5px'
imgDownload.style.padding='10px'
imgDownload.style.fontFamily='"Open Sans", "Courier New"'
imgDownload.style.fontSize='12px'
imgDownload.style.color='white'
var windowImgMaximize = document.createElement('img')

div_93.appendChild(imgDownload)

windowImgMaximize.style.cursor='pointer'
windowImgMaximize.setAttribute('src', './img/baseline_aspect_ratio_black_18dp.png')
var windowImgClose = document.createElement('img')

div_93.appendChild(windowImgMaximize)

windowImgClose.style.cursor='pointer'
windowImgClose.setAttribute('src', './img/baseline_highlight_off_black_18dp.png')
var contentArea = document.createElement('div')

div_93.appendChild(windowImgClose)


topBar.appendChild(div_93)


root.appendChild(topBar)

contentArea.style.display='flex'
contentArea.style.display='none'
contentArea.style.flexGrow='1'
contentArea.style.overflow='auto'
contentArea.style.backgroundColor='white'
var codeArea = document.createElement('div')

root.appendChild(contentArea)

codeArea.style.display='flex'
codeArea.style.flexGrow='1'
var textareaCode = document.createElement('textarea')
textareaCode.style.resize='none'
textareaCode.style.width='100%'
textareaCode.style.height='100%'
textareaCode.style.fontFamily='Consolas, "Courier New", monospace'
textareaCode.style.fontSize='14px'
textareaCode.style.backgroundColor='black'
textareaCode.style.color='white'
var textareaScript = document.createElement('textarea')

codeArea.appendChild(textareaCode)

textareaScript.style.resize='none'
textareaScript.style.width='100%'
textareaScript.style.height='100%'
textareaScript.style.fontFamily='Consolas, "Courier New", monospace'
textareaScript.style.fontSize='14px'
textareaScript.style.backgroundColor='black'
textareaScript.style.color='white'
textareaScript.style.display='none'
var textareaCss = document.createElement('textarea')

codeArea.appendChild(textareaScript)

textareaCss.style.resize='none'
textareaCss.style.width='100%'
textareaCss.style.height='100%'
textareaCss.style.fontFamily='Consolas, "Courier New", monospace'
textareaCss.style.fontSize='14px'
textareaCss.style.backgroundColor='black'
textareaCss.style.color='white'
textareaCss.style.display='none'
var resizer = document.createElement('div')

codeArea.appendChild(textareaCss)


root.appendChild(codeArea)

resizer.style.position='absolute'
resizer.style.width='3px'
resizer.style.height='3px'
resizer.style.borderRadius='50%'
resizer.style.border='3px solid #4286f4'
resizer.style.right='-5px'
resizer.style.bottom='-5px'
resizer.style.cursor='nwse-resize'

root.appendChild(resizer)

textareaCode.onkeydown = ev => {
    if(ev.keyCode == 9){
        ev.preventDefault()
        //prendo il caret e aggiungo quattro spazi
        const caretPos = textareaCode.selectionStart
        const startCode1 = 0
        const strFirstLen = textareaCode.value.substr(0, caretPos)
        const strLen = textareaCode.value
        const strSecondLen = strLen.length-strFirstLen.length
        textareaCode.value = textareaCode.value.substr(0, caretPos) + "    " + textareaCode.value.substr(caretPos, strSecondLen)
        textareaCode.selectionEnd = caretPos + 4
    } 
}

textareaScript.onkeydown = ev => {
    if(ev.keyCode == 9){
        ev.preventDefault()
        //prendo il caret e aggiungo quattro spazi
        const caretPos = textareaScript.selectionStart
        const startCode1 = 0
        const strFirstLen = textareaScript.value.substr(0, caretPos)
        const strLen = textareaScript.value
        const strSecondLen = strLen.length-strFirstLen.length
        textareaScript.value = textareaScript.value.substr(0, caretPos) + "    " + textareaScript.value.substr(caretPos, strSecondLen)
        textareaScript.selectionEnd = caretPos + 4
    } 
}

textareaCss.onkeydown = ev => {
    if(ev.keyCode == 9){
        ev.preventDefault()
        //prendo il caret e aggiungo quattro spazi
        const caretPos = textareaCss.selectionStart
        const startCode1 = 0
        const strFirstLen = textareaCss.value.substr(0, caretPos)
        const strLen = textareaCss.value
        const strSecondLen = strLen.length-strFirstLen.length
        textareaCss.value = textareaCss.value.substr(0, caretPos) + "    " + textareaCss.value.substr(caretPos, strSecondLen)
        textareaCss.selectionEnd = caretPos + 4
    } 
}

mnuFile.style.display = 'none'
ctaFile.onclick = ev => {
    var rect = ctaFile.getBoundingClientRect()
    mnuFile.style.display = 'initial'
    mnuFile.style.position = 'fixed'
    mnuFile.style.top = rect.bottom +'px'
    mnuFile.style.left = rect.left + 'px'
    mnuFile.style.padding = '10px'
}

// *********** mnuFile
var isMouseOver = false

mnuFile.style.display = 'none'
ctaFile.onclick = ev => {
    var rect = ctaFile.getBoundingClientRect()
    mnuFile.style.display = 'initial'
    mnuFile.style.position = 'fixed'
    mnuFile.style.top = rect.bottom +'px'
    mnuFile.style.left = rect.left + 'px'
    mnuFile.style.padding = '10px'
}

ctaFile.onmouseover = ev => {
    ctaFile.style.background = 'rgb(35,38,39)'
    ctaFile.style.background = 'radial-gradient(circle, rgba(35,38,39,0.9982274159663865) 100%, rgba(235,235,235,1) 100%, rgba(86,110,159,1) 100%)'
}

ctaFile.onmouseleave = ev => {
    ctaFile.style.background = 'initial'

    if(!isMouseOver) mnuFile.style.display = 'none'
}

mnuFile.onmouseover = ev => {
    isMouseOver = true
}

mnuFile.onmouseleave = ev => {
    isMouseOver = false
}
// *************************************************


// *********** mnuTools
mnuTools.style.display = 'none'
ctaTools.onclick = ev => {
    var rect = ctaTools.getBoundingClientRect()
    mnuTools.style.display = 'initial'
    mnuTools.style.position = 'fixed'
    mnuTools.style.top = rect.bottom +'px'
    mnuTools.style.left = rect.left + 'px'
    mnuTools.style.padding = '10px'
}

ctaTools.onmouseover = ev => {
    ctaTools.style.background = 'rgb(35,38,39)'
    ctaTools.style.background = 'radial-gradient(circle, rgba(35,38,39,0.9982274159663865) 100%, rgba(235,235,235,1) 100%, rgba(86,110,159,1) 100%)'
}

ctaTools.onmouseleave = ev => {
    ctaTools.style.background = 'initial'

    if(!isMouseOver) mnuTools.style.display = 'none'
}
// *************************************



windowImgClose.onmouseover = ev => {
    windowImgClose.style.filter = 'saturate(8)';
}

windowImgClose.onclick = ev => {
    root.style.display = 'none';
}

windowImgMaximize.onclick = ev => {
    root.style.left = '0px';
    root.style.top = '0px';
    root.style.width = document.body.clientWidth + 'px';
    root.style.height = document.body.clientHeight + 'px';
}

imgCode.onclick = ev => {
    codeArea.style.display = 'flex'
    textareaCode.style.display = 'block'
    textareaScript.style.display = 'none'
    textareaCss.style.display = 'none'
    contentArea.style.display = 'none'

    imgCode.style.backgroundColor = 'blue'    
    imgScript.style.backgroundColor = 'initial'
    imgCss.style.backgroundColor = 'initial'

    textareaCode.focus()
}

imgScript.onclick = ev => {
    codeArea.style.display = 'flex'
    textareaCode.style.display = 'none'
    textareaScript.style.display = 'block'
    textareaCss.style.display = 'none'
    contentArea.style.display = 'none'

    imgCode.style.backgroundColor = 'initial'    
    imgScript.style.backgroundColor = 'blue'
    imgCss.style.backgroundColor = 'initial'

    textareaScript.focus()
}

imgCss.onclick = ev => {
    codeArea.style.display = 'flex'
    textareaCode.style.display = 'none'
    textareaScript.style.display = 'none'
    textareaCss.style.display = 'block'
    contentArea.style.display = 'none'

    imgCode.style.backgroundColor = 'initial'    
    imgScript.style.backgroundColor = 'initial'
    imgCss.style.backgroundColor = 'red'

    textareaCss.focus()
}

var count = 0
imgPreview.onclick = ev => {
    count++
    codeArea.style.display = 'none'
    
    var code =document.parser('functionName', textareaCode.value, textareaScript.value, textareaCss.value)
/*     var script = document.createElement('script')
    script.append(document.createTextNode(code)) */

    // DA OTTIMIZZARE ATTACCA UNO SCRIPT PER OGNI COMPILAZIONE
    //document.body.appendChild(script)
    //document.json('saveGenScript', {fileName: fileName.value, code: code})
    //document.register('saveGenScript' ev => {
    //    alert(ev.detail)
    //})
    
    document.json('saveGenScript', {fileName: fileName.value, code:code}).then(data=>{
        console.log('saved.')
        //scriptArea.innerHTML = ''
        //scriptArea.append(document.createTextNode(code))
        
        var fileToImport = fileName.value.substr(0,fileName.value.length-3)
        import('./'+fileToImport+'.js?'+count).then(module => {
            var dom = module.default()
            contentArea.style.display = 'flex'
            contentArea.innerHTML = ''
            contentArea.append(dom)
        })
    })

/* fetch('/saveGenScript', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        mode: 'same-origin', 
        cache: 'no-cache', 
        body: JSON.stringify({fileName: fileName.value, code: code})
    }).then(res => {
        console.log('saved.')
        //scriptArea.innerHTML = ''
        //scriptArea.append(document.createTextNode(code))
        
        var fileToImport = fileName.value.substr(0,fileName.value.length-3)
        import('./'+fileToImport+'.js?'+count).then(module => {
            var dom = module.default()
            contentArea.style.display = 'flex'
            contentArea.innerHTML = ''
            contentArea.append(dom)
        })
    }) */




    //document.eventManager('windowDev.imgPreviewClicked', {fileName: "test.ux", code: textareaCode.value})
}

imgSaveAlt.onhover = ev => {
    
}

imgSaveAlt.onclick = ev => {
    imgSaveAlt.style.backgroundColor = 'red'

    document.json('commitStore',document.store).then(data=> console.log('store saved - ' + JSON.stringify(data)) )

    document.json('saveAs', {fileName:fileName.value, code:textareaCode.value, scriptCode:textareaScript.value, cssCode:textareaCss.value}).then(data=>{
        console.log('saved')
        if(data.esito=='done'){
            //TOOLTIP SAVED
        } else if (data.esito=='login'){
            document.em('accordion.showRegister')
        }
        else {
            //login
            //Home Desktop deve allegare la window di login
            //document.em('homeDesktop.showLogin')
        }
    })

/*     fetch('/saveAs', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        mode: 'same-origin', 
        cache: 'no-cache', 
        body: JSON.stringify({fileName: fileName.value, code: textareaCode.value, scriptCode: textareaScript.value})
    }).then(res => {
        console.log('saved.')
    }) */
}

function makeResizableDiv(div, resizer) {
    const element = div;
    const currentResizer = resizer;

    currentResizer.addEventListener('mousedown', function(e) {
        e.preventDefault();
        document.body.addEventListener('mousemove', resize);
        document.body.addEventListener('mouseup', stopResize);
    });
    
    function resize(e) {
        element.style.width = e.pageX - element.getBoundingClientRect().left + 'px';
        element.style.height = e.pageY - element.getBoundingClientRect().top + 'px';
    }
    
    function stopResize() {
        document.body.removeEventListener('mousemove', resize);
    }
    
}
  
makeResizableDiv(root, resizer);

function makeMovableDiv(div, resizer){

    var prevX = 0;
    var prevY = 0;
    var initX = 0;
    var initY = 0;

    const element = div;
    const currentResizer = resizer;

    currentResizer.addEventListener('mousedown', function(e){
        e.preventDefault();

        prevX = e.clientX;
        prevY = e.clientY;
    
        var rect = root.getBoundingClientRect();
    
        initX = rect.x;
        initY = rect.y;

        document.body.addEventListener('mousemove', move);
        document.body.addEventListener('mouseup', stopMove);
    });

    function move(e) {
        let newX = prevX - e.clientX;
        let newY = prevY - e.clientY;

        root.style.left = initX - newX +'px';
        root.style.top = initY - newY +'px';
    }
    
    function stopMove() {
        document.body.removeEventListener('mousemove', move);
    }
}

makeMovableDiv(root, windowImgMove);

  
root.contentArea = contentArea

var v = 0
function updateContent (ev){

/*     (async () => {
        const myModule = await import('./test_0.js');

        contentArea.innerHTML = ''
        contentArea.append(myModule.default())
        contentArea.style.display = 'block'

    })(); */
    console.log('importing...')
    import('./test.js?query='+v).then(module => {
        contentArea.innerHTML = ''
        contentArea.append(module.default())
        contentArea.style.display = 'block'
    }).catch((err)=>{
        console.log('catch - ' + err)
    })

    v++

}

document.registerDefault(updateContent)

document.register('showFile', ev=>{
    count++

    document.json('file', {fileName:ev.detail.fileName}).then(data=>{
        textareaCode.value = data.code
        textareaScript.value = data.scriptCode
        textareaCss.value = data.cssCode
        fileName.value = ev.detail.fileName
        
        var fileToImport = fileName.value.substr(0,fileName.value.length-3)
        import('./'+fileToImport+'.js?'+count).then(module => {
            var dom = module.default()
            contentArea.innerHTML = ''
            contentArea.append(dom)
            root.style.display = 'flex'
        })        
    })

/*     fetch('/file', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({fileName: ev.detail.fileName})
      }).then(res=>{
        return res.json()
    }).then(data=>{
        textareaCode.value = data.code
        textareaScript.value = data.scriptCode
        fileName.value = ev.detail.fileName
        
        var fileToImport = fileName.value.substr(0,fileName.value.length-3)
        import('./'+fileToImport+'.js?'+count).then(module => {
            var dom = module.default()
            contentArea.innerHTML = ''
            contentArea.append(dom)
        })
        
    }) */
})

document.register('windowDev.textareaCode.append', ev => {
    
    var riga = ev.detail.varName + '.style.' + ev.detail.propertyName + ' = ' + "'" + ev.detail.propertyValue + "'"
    textareaCss.value = textareaCss.value + '\n' + riga
})


imgDesign.onclick = ev => {
    // Per ogni elemento mouseonover
    // Cambio i bordi
    var stack = []

    
    stack.push(contentArea.children)

    while(stack.length!=0){
        var ch = stack.pop()

        Array.from(ch).forEach( v => {
            if(v.nodeType==1){
                v.onmouseover = ev => {
                    ev.target.style.border = '2px solid orange'
                }
                v.onmouseout = ev => {
                    ev.target.style.border = 'initial'
                }
                v.onclick = ev => {
                    ev.preventDefault()
                    ev.stopPropagation()
                    //Invio il dom alla paletta
                    document.em('paletta', {dom:ev.target})
                }
                stack.push(v.children)
            }
            
        })
    }
    // Per ogni elemento onclick
}

imgDownload.onclick = ev => {
    // Genero il file da scaricare 

    // faccio partire il download
    alert('Work in progress')
}


textareaCode.value = "div root\n    h1 'Hello World\n    a 'kate-code\n        .href http://katecode.herokuapp.com"

textareaScript.value = "root.style.backgroundColor = 'blue'"



//            img imgCode
//                -cursor pointer
//                .onmouseover ev => {imgCode.src="./img/baseline_code_black_18dp.png"}
//                .onmouseleave ev => {imgCode.src="./img/baseline_code_white_18dp.png"}
//                .src ./img/baseline_code_white_18dp.png
root.setAttribute('ux-comp-name','windowDev')
let style = document.createElement('style')
style.setAttribute('ux-comp-name-css','windowDev')
style.textContent = ``
root.appendChild(style)
return root
}
</script></body></html>
